name: Git Hash Security Check

on:
  pull_request:
  push:
    branches:
      - develop
      - trunk
  workflow_dispatch:

permissions:
  contents: read

jobs:
  check-git-hash-security:
    name: Verify Full Git Commit Hashes
    runs-on: ubuntu-latest
    steps:
      - name: Check out the source code
        uses: actions/checkout@v5

      - name: Check for short git hashes in package.json
        uses: Automattic/vip-actions/git-hash-security-check@7b98dcb98d652bf02037977b1b85abb971c345d0
