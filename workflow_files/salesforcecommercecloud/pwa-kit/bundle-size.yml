# WARNING! Conditionals are set as variables to minimize repetitive checks.
# However, this results in the variables being the *string* values "true" or "false".
# As a result, you must always explicitly check for those strings. For example,
# ${{ env.DEVELOP }} will ALWAYS evaluate as true; to achieve the expected result
# you must check ${{ env.DEVELOP == 'true' }}. There's probably a better way to DRY,
# but this is what we have for now.

name: SalesforceCommerceCloud/pwa-kit/bundle-size
on:
  pull_request: # Default: opened, reopened, synchronize (head branch updated)
  merge_group: # Trigger GA workflow when a pull request is added to a merge queue.
  push:
    branches:
      - develop
      - 'release-*'

jobs:
  pwa-kit-bundle-size:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 22 # Use latest LTS version for bundle size check
          cache: npm

      - name: Setup Ubuntu Machine
        uses: "./.github/actions/setup_ubuntu"

      - name: Run bundlesize test
        uses: "./.github/actions/bundle_size_test"

