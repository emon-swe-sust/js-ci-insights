name: Push to community subtree

on:
  workflow_dispatch: 
    inputs:
      ref:
        type: string
        description: The git ref to push to subtree, can be a branch refs/heads/dev or a tag refs/tags/10.0.0
      ref_name:
        description: The git ref name to push to subtree, can be a branch dev or a tag 10.0.0
        type: string
  push:
    branches: 
      - 'dev'

jobs:
  push-subtree:
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.BONITA_CI_PAT }}
          ref: ${{ github.event.inputs.ref || github.ref }}
          fetch-depth: 0
          
      - name: Push to subtree
        run: |
          git config remote.public.url >&- || git remote add public https://github.com/bonitasoft/bonita-ui-designer.git
          git push public ${{ github.event.inputs.ref_name || github.ref_name }}